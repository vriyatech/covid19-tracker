{"ast":null,"code":"var _jsxFileName = \"D:\\\\programming\\\\react\\\\new covid\\\\covid19\\\\src\\\\components\\\\Region.js\";\nimport React, { Component } from 'react';\nimport Select from 'react-select';\nimport { GoFold, GoUnfold, GoSearch } from 'react-icons/go';\nimport RegionDropdown from './RegionDropdown';\nimport RegionSelectOption from './RegionSelectOption';\nimport { formatDate, getDataFromRegion } from '../utils/utils';\nimport * as str from '../utils/strings';\nimport i18n from '../data/i18n.yml';\nconst selectStyles = {\n  control: (provided, state) => ({ ...provided,\n    minWidth: 240,\n    marginBottom: 8,\n    borderRadius: 30\n  }),\n  menu: () => ({\n    backgroundColor: 'white',\n    boxShadow: '0 0 0 1px hsla(218, 50%, 10%, 0.1), 0 4px 11px hsla(218, 50%, 10%, 0.1)',\n    cursor: 'pointer'\n  }),\n  option: (provided, state) => ({ ...provided,\n    textAlign: 'left',\n    fontSize: 12,\n    backgroundColor: state.isFocused ? 'var(--primary-color-5)' : state.isSelected ? '#eee' : null,\n    color: state.isFocused ? '#fff' : '#000',\n    cursor: 'pointer'\n  })\n};\nconst selectStylesDark = {\n  control: (provided, state) => ({ ...provided,\n    minWidth: 240,\n    marginBottom: 8,\n    borderRadius: 30\n  }),\n  menu: () => ({\n    backgroundColor: 'var(--dark-grey)',\n    boxShadow: '0 0 0 1px hsla(218, 50%, 10%, 0.1), 0 4px 11px hsla(218, 50%, 10%, 0.1)',\n    cursor: 'pointer'\n  }),\n  option: (provided, state) => ({ ...provided,\n    textAlign: 'left',\n    fontSize: 12,\n    backgroundColor: state.isFocused ? 'var(--primary-color-4)' : state.isSelected ? '#777' : null,\n    color: 'var(--lighter-grey)',\n    cursor: 'pointer'\n  })\n};\nexport default class Region extends Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      isOpen: false,\n      value: undefined,\n      options: [],\n      countryOnly: true\n    };\n\n    this.toggleOpen = () => {\n      this.setState(state => ({\n        isOpen: !state.isOpen\n      }));\n    };\n\n    this.toggleCountryOnly = () => {\n      this.props.ReactTooltip.hide(this.regionSelectMore);\n      this.setState({\n        countryOnly: !this.state.countryOnly\n      });\n    };\n\n    this.onSelectChange = selected => {\n      this.toggleOpen();\n      this.setState({\n        value: selected\n      });\n      this.props.regionToggle(selected.region);\n    };\n\n    this.generateOptions = root => {\n      const {\n        data,\n        lang,\n        date,\n        metric\n      } = this.props;\n      const englishRoot = [...Array(root.length).keys()].map(i => root.slice(0, i + 1)).map(regionList => getDataFromRegion(data, regionList).ENGLISH);\n      let options = [];\n      const regionData = getDataFromRegion(data, root);\n      Object.keys(regionData).filter(d => !['confirmedCount', 'deadCount', 'curedCount', 'ENGLISH'].includes(d)).sort((a, b) => {\n        const aCount = regionData[a][metric][date] ? regionData[a][metric][date] : 0;\n        const bCount = regionData[b][metric][date] ? regionData[b][metric][date] : 0;\n        return aCount > bCount ? -1 : 1;\n      }).forEach(d => {\n        options.push({\n          value: lang === 'zh' ? [...root, d].join('') : [...englishRoot, regionData[d].ENGLISH].join(''),\n          region: [...root, d],\n          label: /*#__PURE__*/React.createElement(RegionSelectOption, {\n            region: lang === 'zh' ? [...root, d] : [...englishRoot, regionData[d].ENGLISH],\n            data: regionData[d],\n            date: date,\n            metric: metric,\n            __self: this,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 128,\n              columnNumber: 25\n            }\n          })\n        });\n        const childData = getDataFromRegion(data, [...root, d]);\n        const showSubRegions = [str.CHINA_ZH, str.FRANCE_ZH, str.UK_ZH, str.NETHERLANDS_ZH, str.DENMARK_ZH];\n        if (Object.keys(childData).length > 4 && (!this.state.countryOnly || root.length === 0 && showSubRegions.includes(d))) options = [...options, ...this.generateOptions([...root, d])];\n      });\n      return options;\n    };\n\n    this.displayRegionName = () => {\n      const {\n        currentRegion,\n        data,\n        lang\n      } = this.props; // remove duplicates in case same region occurs at different level (e.g. Japan)\n\n      let region = [...new Set(currentRegion)];\n\n      if (lang === 'zh') {\n        region = region.join(''); // China\n\n        region = region !== str.CHINA_ZH ? region.replace(str.CHINA_ZH, '') : str.CHINA_ZH;\n        region = region !== str.INTL_CONVEYANCE_ZH ? region.replace(str.INTL_CONVEYANCE_ZH, '') : str.INTL_CONVEYANCE_ZH;\n        region = region !== str.MAINLAND_CHINA_ZH ? region.replace(str.MAINLAND_CHINA_ZH, '') : str.MAINLAND_CHINA_ZH; // France\n\n        region = region !== `${str.FRANCE_ZH}${str.METRO_FRANCE_ZH}` ? region.replace(str.METRO_FRANCE_ZH, '') : str.METRO_FRANCE_ZH;\n        region = region !== `${str.FRANCE_ZH}${str.OVERSEAS_FRANCE_ZH}` ? region.replace(`${str.FRANCE_ZH}${str.OVERSEAS_FRANCE_ZH}`, '') : `${str.FRANCE_ZH}${str.OVERSEAS_FRANCE_ZH}`; // UK\n\n        region = region !== `${str.UK_ZH}${str.OVERSEAS_TERRITORIES_ZH}` ? region.replace(`${str.UK_ZH}${str.OVERSEAS_TERRITORIES_ZH}`, '') : `${str.UK_ZH}${str.OVERSEAS_TERRITORIES_ZH}`;\n        region = region !== `${str.UK_ZH}${str.CROWN_DEPENDENCIES_ZH}` ? region.replace(`${str.UK_ZH}${str.CROWN_DEPENDENCIES_ZH}`, '') : `${str.UK_ZH}${str.CROWN_DEPENDENCIES_ZH}`;\n        return region;\n      } else {\n        if (data == null) return;\n        let englishRegion = [...Array(currentRegion.length).keys()].map(i => currentRegion.slice(0, i + 1)).map(regionList => getDataFromRegion(data, regionList).ENGLISH);\n        englishRegion = [...new Set(englishRegion)];\n        region = englishRegion.reverse().join(', '); // China\n\n        region = region !== str.CHINA_EN ? region.replace(`, ${str.CHINA_EN}`, '') : str.CHINA_EN;\n        region = region !== str.MAINLAND_CHINA_EN ? region.replace(`, ${str.MAINLAND_CHINA_EN}`, '') : str.MAINLAND_CHINA_EN; // France\n\n        region = region !== `${str.METRO_FRANCE_EN}, ${str.FRANCE_EN}` ? region.replace(`, ${str.METRO_FRANCE_EN}`, '') : str.METRO_FRANCE_EN;\n        region = region !== `${str.OVERSEAS_FRANCE_EN}, ${str.FRANCE_EN}` ? region.replace(`, ${str.OVERSEAS_FRANCE_EN}, ${str.FRANCE_EN}`, '') : str.OVERSEAS_FRANCE_EN; // Cruise ship\n\n        region = region !== str.INTL_CONVEYANCE_EN ? region.replace(`, ${str.INTL_CONVEYANCE_EN}`, '') : str.INTL_CONVEYANCE_EN; // USA\n\n        region = region !== str.US_EN ? region.replace(str.US_EN, 'US') : str.US_EN; // UK\n\n        region = region !== str.UK_EN ? region.replace(str.UK_EN, 'UK') : str.UK_EN;\n        region = region !== `${str.OVERSEAS_TERRITORIES_EN}, ${str.UK_ABBR_EN}` ? region.replace(`, ${str.OVERSEAS_TERRITORIES_EN}, ${str.UK_ABBR_EN}`, '') : str.OVERSEAS_TERRITORIES_EN;\n        region = region !== `${str.CROWN_DEPENDENCIES_EN}, ${str.UK_ABBR_EN}` ? region.replace(`, ${str.CROWN_DEPENDENCIES_EN}, ${str.UK_ABBR_EN}`, '') : str.CROWN_DEPENDENCIES_EN;\n        return region;\n      }\n    };\n\n    this.displayDate = () => {\n      const {\n        lang,\n        date\n      } = this.props;\n      return formatDate(date, lang);\n    };\n  }\n\n  componentDidMount() {\n    const options = this.generateOptions([]);\n    this.setState({\n      options,\n      value: {\n        value: this.props.lang === 'zh' ? str.GLOBAL_ZH : str.GLOBAL_EN\n      }\n    });\n  }\n\n  componentDidUpdate(prevProps, prevState) {\n    if (prevProps.lang !== this.props.lang || prevProps.metric !== this.props.metric || prevProps.date !== this.props.date || prevState.countryOnly !== this.state.countryOnly) {\n      const options = this.generateOptions([]);\n      this.setState({\n        options\n      });\n    }\n\n    if (prevState.isOpen !== this.state.isOpen || prevState.countryOnly !== this.state.countryOnly) {\n      this.props.ReactTooltip.rebuild();\n    }\n\n    if (prevProps.currentRegion !== this.props.currentRegion) {\n      const {\n        data,\n        currentRegion,\n        lang\n      } = this.props;\n      const englishRegion = [...Array(currentRegion.length).keys()].map(i => currentRegion.slice(0, i + 1)).map(regionList => getDataFromRegion(data, regionList).ENGLISH);\n      this.setState({\n        value: {\n          value: lang === 'zh' ? currentRegion.join('') : englishRegion.join('')\n        }\n      });\n    }\n  }\n\n  render() {\n    const {\n      isOpen,\n      value,\n      countryOnly\n    } = this.state;\n    if (this.props.data == null) return;\n    const MoreIcon = countryOnly ? GoUnfold : GoFold;\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"current-region-wrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 245,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(RegionDropdown, {\n      isOpen: isOpen,\n      onClose: this.toggleOpen,\n      target: /*#__PURE__*/React.createElement(\"div\", {\n        className: \"current-region\",\n        onClick: this.toggleOpen,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 250,\n          columnNumber: 25\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 251,\n          columnNumber: 29\n        }\n      }, this.displayRegionName()), /*#__PURE__*/React.createElement(GoSearch, {\n        size: 18,\n        className: \"dropdown-arrow\",\n        style: {\n          transform: 'translateY(1px)'\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 252,\n          columnNumber: 29\n        }\n      })),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Select, {\n      classNamePrefix: 'region-select',\n      autoFocus: true,\n      backspaceRemovesValue: false,\n      components: {\n        DropdownIndicator: () => /*#__PURE__*/React.createElement(\"span\", {\n          className: \"region-select-more\",\n          onMouseUp: this.toggleCountryOnly,\n          onTouchEnd: this.toggleCountryOnly,\n          onMouseEnter: () => this.props.ReactTooltip.show(this.regionSelectMore),\n          onMouseLeave: () => this.props.ReactTooltip.hide(this.regionSelectMore),\n          ref: ref => this.regionSelectMore = ref,\n          \"data-tip\": countryOnly ? i18n.MORE_REGIONS_HELP_TEXT[this.props.lang] : i18n.LESS_REGIONS_HELP_TEXT[this.props.lang],\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 262,\n            columnNumber: 33\n          }\n        }, /*#__PURE__*/React.createElement(MoreIcon, {\n          size: 16,\n          color: this.props.darkMode ? 'var(--primary-color-4)' : 'var(--primary-color-5)',\n          __self: this,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 277,\n            columnNumber: 37\n          }\n        })),\n        IndicatorSeparator: null\n      },\n      controlShouldRenderValue: false,\n      hideSelectedOptions: false,\n      isClearable: false,\n      menuIsOpen: true,\n      onChange: this.onSelectChange,\n      options: this.state.options,\n      placeholder: `${i18n.SEARCH[this.props.lang]} ...... `,\n      styles: this.props.darkMode ? selectStylesDark : selectStyles,\n      tabSelectsValue: false,\n      value: value,\n      noOptionsMessage: () => i18n.NO_RESULT[this.props.lang],\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 256,\n        columnNumber: 21\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"current-date\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 300,\n        columnNumber: 17\n      }\n    }, this.displayDate()));\n  }\n\n}","map":{"version":3,"sources":["D:/programming/react/new covid/covid19/src/components/Region.js"],"names":["React","Component","Select","GoFold","GoUnfold","GoSearch","RegionDropdown","RegionSelectOption","formatDate","getDataFromRegion","str","i18n","selectStyles","control","provided","state","minWidth","marginBottom","borderRadius","menu","backgroundColor","boxShadow","cursor","option","textAlign","fontSize","isFocused","isSelected","color","selectStylesDark","Region","isOpen","value","undefined","options","countryOnly","toggleOpen","setState","toggleCountryOnly","props","ReactTooltip","hide","regionSelectMore","onSelectChange","selected","regionToggle","region","generateOptions","root","data","lang","date","metric","englishRoot","Array","length","keys","map","i","slice","regionList","ENGLISH","regionData","Object","filter","d","includes","sort","a","b","aCount","bCount","forEach","push","join","label","childData","showSubRegions","CHINA_ZH","FRANCE_ZH","UK_ZH","NETHERLANDS_ZH","DENMARK_ZH","displayRegionName","currentRegion","Set","replace","INTL_CONVEYANCE_ZH","MAINLAND_CHINA_ZH","METRO_FRANCE_ZH","OVERSEAS_FRANCE_ZH","OVERSEAS_TERRITORIES_ZH","CROWN_DEPENDENCIES_ZH","englishRegion","reverse","CHINA_EN","MAINLAND_CHINA_EN","METRO_FRANCE_EN","FRANCE_EN","OVERSEAS_FRANCE_EN","INTL_CONVEYANCE_EN","US_EN","UK_EN","OVERSEAS_TERRITORIES_EN","UK_ABBR_EN","CROWN_DEPENDENCIES_EN","displayDate","componentDidMount","GLOBAL_ZH","GLOBAL_EN","componentDidUpdate","prevProps","prevState","rebuild","render","MoreIcon","transform","DropdownIndicator","show","ref","MORE_REGIONS_HELP_TEXT","LESS_REGIONS_HELP_TEXT","darkMode","IndicatorSeparator","SEARCH","NO_RESULT"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\r\nimport Select from 'react-select'\r\nimport { GoFold, GoUnfold, GoSearch } from 'react-icons/go'\r\nimport RegionDropdown from './RegionDropdown'\r\nimport RegionSelectOption from './RegionSelectOption'\r\nimport { formatDate, getDataFromRegion } from '../utils/utils'\r\nimport * as str from '../utils/strings'\r\nimport i18n from '../data/i18n.yml'\r\n\r\nconst selectStyles = {\r\n    control: (provided, state) => ({\r\n        ...provided,\r\n        minWidth: 240,\r\n        marginBottom: 8,\r\n        borderRadius: 30\r\n    }),\r\n    menu: () => ({\r\n        backgroundColor: 'white',\r\n        boxShadow: '0 0 0 1px hsla(218, 50%, 10%, 0.1), 0 4px 11px hsla(218, 50%, 10%, 0.1)',\r\n        cursor: 'pointer'\r\n    }),\r\n    option: (provided, state) => ({\r\n        ...provided,\r\n        textAlign: 'left',\r\n        fontSize: 12,\r\n        backgroundColor: state.isFocused ? 'var(--primary-color-5)' : state.isSelected ? '#eee' : null,\r\n        color: state.isFocused ? '#fff' : '#000',\r\n        cursor: 'pointer'\r\n    })\r\n}\r\n\r\nconst selectStylesDark = {\r\n    control: (provided, state) => ({\r\n        ...provided,\r\n        minWidth: 240,\r\n        marginBottom: 8,\r\n        borderRadius: 30\r\n    }),\r\n    menu: () => ({\r\n        backgroundColor: 'var(--dark-grey)',\r\n        boxShadow: '0 0 0 1px hsla(218, 50%, 10%, 0.1), 0 4px 11px hsla(218, 50%, 10%, 0.1)',\r\n        cursor: 'pointer'\r\n    }),\r\n    option: (provided, state) => ({\r\n        ...provided,\r\n        textAlign: 'left',\r\n        fontSize: 12,\r\n        backgroundColor: state.isFocused ? 'var(--primary-color-4)' : state.isSelected ? '#777' : null,\r\n        color: 'var(--lighter-grey)',\r\n        cursor: 'pointer'\r\n    })\r\n}\r\n\r\nexport default class Region extends Component {\r\n    state = {\r\n        isOpen: false,\r\n        value: undefined,\r\n        options: [],\r\n        countryOnly: true\r\n    }\r\n\r\n    componentDidMount() {\r\n        const options = this.generateOptions([])\r\n        this.setState({ options, value: { value: this.props.lang === 'zh' ? str.GLOBAL_ZH : str.GLOBAL_EN } })\r\n    }\r\n\r\n    componentDidUpdate(prevProps, prevState) {\r\n        if (\r\n            prevProps.lang !== this.props.lang ||\r\n            prevProps.metric !== this.props.metric ||\r\n            prevProps.date !== this.props.date ||\r\n            prevState.countryOnly !== this.state.countryOnly\r\n        ) {\r\n            const options = this.generateOptions([])\r\n            this.setState({ options })\r\n        }\r\n\r\n        if (prevState.isOpen !== this.state.isOpen || prevState.countryOnly !== this.state.countryOnly) {\r\n            this.props.ReactTooltip.rebuild()\r\n        }\r\n\r\n        if (prevProps.currentRegion !== this.props.currentRegion) {\r\n            const { data, currentRegion, lang } = this.props\r\n            const englishRegion = [ ...Array(currentRegion.length).keys() ]\r\n                .map((i) => currentRegion.slice(0, i + 1))\r\n                .map((regionList) => getDataFromRegion(data, regionList).ENGLISH)\r\n            this.setState({ value: { value: lang === 'zh' ? currentRegion.join('') : englishRegion.join('') } })\r\n        }\r\n    }\r\n\r\n    toggleOpen = () => {\r\n        this.setState((state) => ({ isOpen: !state.isOpen }))\r\n    }\r\n\r\n    toggleCountryOnly = () => {\r\n        this.props.ReactTooltip.hide(this.regionSelectMore)\r\n        this.setState({\r\n            countryOnly: !this.state.countryOnly\r\n        })\r\n    }\r\n\r\n    onSelectChange = (selected) => {\r\n        this.toggleOpen()\r\n        this.setState({ value: selected })\r\n        this.props.regionToggle(selected.region)\r\n    }\r\n\r\n    generateOptions = (root) => {\r\n        const { data, lang, date, metric } = this.props\r\n        const englishRoot = [ ...Array(root.length).keys() ]\r\n            .map((i) => root.slice(0, i + 1))\r\n            .map((regionList) => getDataFromRegion(data, regionList).ENGLISH)\r\n\r\n        let options = []\r\n        const regionData = getDataFromRegion(data, root)\r\n        Object.keys(regionData)\r\n            .filter((d) => ![ 'confirmedCount', 'deadCount', 'curedCount', 'ENGLISH' ].includes(d))\r\n            .sort((a, b) => {\r\n                const aCount = regionData[a][metric][date] ? regionData[a][metric][date] : 0\r\n                const bCount = regionData[b][metric][date] ? regionData[b][metric][date] : 0\r\n                return aCount > bCount ? -1 : 1\r\n            })\r\n            .forEach((d) => {\r\n                options.push({\r\n                    value: lang === 'zh' ? [ ...root, d ].join('') : [ ...englishRoot, regionData[d].ENGLISH ].join(''),\r\n                    region: [ ...root, d ],\r\n                    label: (\r\n                        <RegionSelectOption\r\n                            region={lang === 'zh' ? [ ...root, d ] : [ ...englishRoot, regionData[d].ENGLISH ]}\r\n                            data={regionData[d]}\r\n                            date={date}\r\n                            metric={metric}\r\n                        />\r\n                    )\r\n                })\r\n                const childData = getDataFromRegion(data, [ ...root, d ])\r\n                const showSubRegions = [ str.CHINA_ZH, str.FRANCE_ZH, str.UK_ZH, str.NETHERLANDS_ZH, str.DENMARK_ZH ]\r\n                if (\r\n                    Object.keys(childData).length > 4 &&\r\n                    (!this.state.countryOnly || (root.length === 0 && showSubRegions.includes(d)))\r\n                )\r\n                    options = [ ...options, ...this.generateOptions([ ...root, d ]) ]\r\n            })\r\n\r\n        return options\r\n    }\r\n\r\n    displayRegionName = () => {\r\n        const { currentRegion, data, lang } = this.props\r\n\r\n        // remove duplicates in case same region occurs at different level (e.g. Japan)\r\n        let region = [ ...new Set(currentRegion) ]\r\n\r\n        if (lang === 'zh') {\r\n            region = region.join('')\r\n            // China\r\n            region = region !== str.CHINA_ZH ? region.replace(str.CHINA_ZH, '') : str.CHINA_ZH\r\n            region =\r\n                region !== str.INTL_CONVEYANCE_ZH ? region.replace(str.INTL_CONVEYANCE_ZH, '') : str.INTL_CONVEYANCE_ZH\r\n            region =\r\n                region !== str.MAINLAND_CHINA_ZH ? region.replace(str.MAINLAND_CHINA_ZH, '') : str.MAINLAND_CHINA_ZH\r\n\r\n            // France\r\n            region =\r\n                region !== `${str.FRANCE_ZH}${str.METRO_FRANCE_ZH}`\r\n                    ? region.replace(str.METRO_FRANCE_ZH, '')\r\n                    : str.METRO_FRANCE_ZH\r\n            region =\r\n                region !== `${str.FRANCE_ZH}${str.OVERSEAS_FRANCE_ZH}`\r\n                    ? region.replace(`${str.FRANCE_ZH}${str.OVERSEAS_FRANCE_ZH}`, '')\r\n                    : `${str.FRANCE_ZH}${str.OVERSEAS_FRANCE_ZH}`\r\n\r\n            // UK\r\n            region =\r\n                region !== `${str.UK_ZH}${str.OVERSEAS_TERRITORIES_ZH}`\r\n                    ? region.replace(`${str.UK_ZH}${str.OVERSEAS_TERRITORIES_ZH}`, '')\r\n                    : `${str.UK_ZH}${str.OVERSEAS_TERRITORIES_ZH}`\r\n            region =\r\n                region !== `${str.UK_ZH}${str.CROWN_DEPENDENCIES_ZH}`\r\n                    ? region.replace(`${str.UK_ZH}${str.CROWN_DEPENDENCIES_ZH}`, '')\r\n                    : `${str.UK_ZH}${str.CROWN_DEPENDENCIES_ZH}`\r\n\r\n            return region\r\n        } else {\r\n            if (data == null) return\r\n            let englishRegion = [ ...Array(currentRegion.length).keys() ]\r\n                .map((i) => currentRegion.slice(0, i + 1))\r\n                .map((regionList) => getDataFromRegion(data, regionList).ENGLISH)\r\n            englishRegion = [ ...new Set(englishRegion) ]\r\n            region = englishRegion.reverse().join(', ')\r\n\r\n            // China\r\n            region = region !== str.CHINA_EN ? region.replace(`, ${str.CHINA_EN}`, '') : str.CHINA_EN\r\n            region =\r\n                region !== str.MAINLAND_CHINA_EN\r\n                    ? region.replace(`, ${str.MAINLAND_CHINA_EN}`, '')\r\n                    : str.MAINLAND_CHINA_EN\r\n\r\n            // France\r\n            region =\r\n                region !== `${str.METRO_FRANCE_EN}, ${str.FRANCE_EN}`\r\n                    ? region.replace(`, ${str.METRO_FRANCE_EN}`, '')\r\n                    : str.METRO_FRANCE_EN\r\n            region =\r\n                region !== `${str.OVERSEAS_FRANCE_EN}, ${str.FRANCE_EN}`\r\n                    ? region.replace(`, ${str.OVERSEAS_FRANCE_EN}, ${str.FRANCE_EN}`, '')\r\n                    : str.OVERSEAS_FRANCE_EN\r\n\r\n            // Cruise ship\r\n            region =\r\n                region !== str.INTL_CONVEYANCE_EN\r\n                    ? region.replace(`, ${str.INTL_CONVEYANCE_EN}`, '')\r\n                    : str.INTL_CONVEYANCE_EN\r\n\r\n            // USA\r\n            region = region !== str.US_EN ? region.replace(str.US_EN, 'US') : str.US_EN\r\n\r\n            // UK\r\n            region = region !== str.UK_EN ? region.replace(str.UK_EN, 'UK') : str.UK_EN\r\n            region =\r\n                region !== `${str.OVERSEAS_TERRITORIES_EN}, ${str.UK_ABBR_EN}`\r\n                    ? region.replace(`, ${str.OVERSEAS_TERRITORIES_EN}, ${str.UK_ABBR_EN}`, '')\r\n                    : str.OVERSEAS_TERRITORIES_EN\r\n            region =\r\n                region !== `${str.CROWN_DEPENDENCIES_EN}, ${str.UK_ABBR_EN}`\r\n                    ? region.replace(`, ${str.CROWN_DEPENDENCIES_EN}, ${str.UK_ABBR_EN}`, '')\r\n                    : str.CROWN_DEPENDENCIES_EN\r\n\r\n            return region\r\n        }\r\n    }\r\n\r\n    displayDate = () => {\r\n        const { lang, date } = this.props\r\n        return formatDate(date, lang)\r\n    }\r\n\r\n    render() {\r\n        const { isOpen, value, countryOnly } = this.state\r\n        if (this.props.data == null) return\r\n\r\n        const MoreIcon = countryOnly ? GoUnfold : GoFold\r\n\r\n        return (\r\n            <div className=\"current-region-wrap\">\r\n                <RegionDropdown\r\n                    isOpen={isOpen}\r\n                    onClose={this.toggleOpen}\r\n                    target={\r\n                        <div className=\"current-region\" onClick={this.toggleOpen}>\r\n                            <div>{this.displayRegionName()}</div>\r\n                            <GoSearch size={18} className=\"dropdown-arrow\" style={{ transform: 'translateY(1px)' }} />\r\n                        </div>\r\n                    }\r\n                >\r\n                    <Select\r\n                        classNamePrefix={'region-select'}\r\n                        autoFocus\r\n                        backspaceRemovesValue={false}\r\n                        components={{\r\n                            DropdownIndicator: () => (\r\n                                <span\r\n                                    className=\"region-select-more\"\r\n                                    onMouseUp={this.toggleCountryOnly}\r\n                                    onTouchEnd={this.toggleCountryOnly}\r\n                                    onMouseEnter={() => this.props.ReactTooltip.show(this.regionSelectMore)}\r\n                                    onMouseLeave={() => this.props.ReactTooltip.hide(this.regionSelectMore)}\r\n                                    ref={(ref) => (this.regionSelectMore = ref)}\r\n                                    data-tip={\r\n                                        countryOnly ? (\r\n                                            i18n.MORE_REGIONS_HELP_TEXT[this.props.lang]\r\n                                        ) : (\r\n                                            i18n.LESS_REGIONS_HELP_TEXT[this.props.lang]\r\n                                        )\r\n                                    }\r\n                                >\r\n                                    <MoreIcon\r\n                                        size={16}\r\n                                        color={\r\n                                            this.props.darkMode ? 'var(--primary-color-4)' : 'var(--primary-color-5)'\r\n                                        }\r\n                                    />\r\n                                </span>\r\n                            ),\r\n                            IndicatorSeparator: null\r\n                        }}\r\n                        controlShouldRenderValue={false}\r\n                        hideSelectedOptions={false}\r\n                        isClearable={false}\r\n                        menuIsOpen\r\n                        onChange={this.onSelectChange}\r\n                        options={this.state.options}\r\n                        placeholder={`${i18n.SEARCH[this.props.lang]} ...... `}\r\n                        styles={this.props.darkMode ? selectStylesDark : selectStyles}\r\n                        tabSelectsValue={false}\r\n                        value={value}\r\n                        noOptionsMessage={() => i18n.NO_RESULT[this.props.lang]}\r\n                    />\r\n                </RegionDropdown>\r\n                <div className=\"current-date\">{this.displayDate()}</div>\r\n            </div>\r\n        )\r\n    }\r\n}\r\n"]},"metadata":{},"sourceType":"module"}